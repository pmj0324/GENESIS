================================================================================
✅ Time 변환 수정 완료: log(x) → log(1+x)
================================================================================

📐 변경 내용:
--------------------------------------------------------------------------------

이전:
-----
ln(x + ε)  또는  log10(x + ε)
  - ε = 1e-10 (매우 작은 값)
  - 0값 처리: NaN → -10.0

문제:
  - x=0일 때 ln(1e-10) = -23.03 (매우 작음)
  - 임의의 대체 값(-10.0) 필요

현재:
-----
ln(1 + x)  또는  log10(1 + x)
  - x=0일 때 ln(1+0) = 0 (자연스러움!)
  - 0값 처리: NaN → 0.0

장점:
  ✅ x=0일 때 log(1+0)=0 (수학적으로 자연스러움)
  ✅ 임의의 값(-10.0) 불필요
  ✅ 역변환도 간단: exp(y) - 1 또는 10^y - 1
  ✅ 작은 값에서 선형에 가까움 (Taylor: log(1+x) ≈ x)

================================================================================
📊 변환 예시
================================================================================

Time (ns) → ln(1 + Time) / 10:
-------------------------------
     0 ns → ln(1 +     0) / 10 = 0.000 / 10 = 0.000  ✅ 자연스러움!
   100 ns → ln(1 +   100) / 10 = 4.615 / 10 = 0.462
  1000 ns → ln(1 +  1000) / 10 = 6.909 / 10 = 0.691
 10000 ns → ln(1 + 10000) / 10 = 9.211 / 10 = 0.921
135232 ns → ln(1 +135232) / 10 = 11.815 / 10 = 1.182

정규화 범위: [0.000, 1.182] (이전: [-1.000, 0.958])

역변환:
-------
normalized = 0.462 → ln_value = 0.462 * 10 = 4.62
                  → time = exp(4.62) - 1 = 100.97 ns  ✅

normalized = 0.000 → ln_value = 0.000 * 10 = 0.0
                  → time = exp(0.0) - 1 = 0 ns  ✅

================================================================================
🔄 수정된 파일
================================================================================

1. dataloader/pmt_dataloader.py
   - Forward: ln(1 + x) 또는 log10(1 + x)
   - 0값 처리: NaN → 0.0

2. utils/denormalization.py  
   - Inverse: exp(y) - 1 또는 10^y - 1

3. training/trainer.py
   - YAML config 내용 출력 추가

================================================================================
📊 예상 출력 (재시작 후)
================================================================================

⚙️  Configuration Loaded
======================================================================

Model Config:
  Architecture: dit
  Hidden: 16, Depth: 3
  Fusion: SUM
  Signal+Geometry scales: (100.0, 10.0, 600.0, 550.0, 550.0)
  Label scales: (50000000.0, 1.0, 1.0, 600.0, 550.0, 550.0)
  Time transform: ln
  Exclude zero time: True

Diffusion Config:
  Timesteps: 1000
  Beta: [0.0001, 0.02]
  Objective: eps
  Schedule: linear
  Use CFG: True
  CFG Scale: 2.0
  CFG Dropout: 0.1

Training Config:
  Epochs: 100
  Batch size: 128
  Learning rate: 0.0001
  Scheduler: cosine
  Early stopping: True (patience=4)

======================================================================

Signal Channels (Raw from dataloader):
  Time   (ch 1): [0.000000, 11.815380] mean=9.211234 std=1.523456  ✅ 범위 변경!

Normalized Signals + Geometry:
  Time   (ch 1): [0.000000, 1.181538] mean=0.921123 std=0.152346  ✅ 0부터 시작!

================================================================================
🚀 서버에서 실행
================================================================================

# 1. 학습 중단 (Ctrl+C)

# 2. Git pull (최신 코드)
git pull

# 3. 캐시 제거
find . -type f -name "*.pyc" -delete
find . -type d -name "__pycache__" -exec rm -rf {} + 2>/dev/null

# 4. 재시작
python scripts/train.py \
    --config configs/default.yaml \
    --data-path /home/work/GENESIS/GENESIS-data/22644_0921_time_shift.h5

================================================================================
